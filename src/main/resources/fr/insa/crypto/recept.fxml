<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.*?>

<BorderPane prefHeight="700.0" prefWidth="1000.0" stylesheets="@styles.css" xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1" 
          fx:controller="fr.insa.crypto.ui.controllers.ReceptController">
    <!-- En-tÃªte -->
    <top>
        <HBox alignment="CENTER_LEFT" styleClass="header" spacing="10" BorderPane.alignment="CENTER">
            <children>
                <Button fx:id="logoutButton" styleClass="button-secondary" text="DÃ©connexion" />
                <Region HBox.hgrow="ALWAYS" />
                <Text fx:id="connectedText" styleClass="user-email" text="ConnectÃ© Ã  : user@example.com" />
                <Button fx:id="refreshButton" styleClass="button-secondary" text="Actualiser" />
                <!-- Indicateur de chargement pour l'actualisation -->
                <ProgressIndicator fx:id="refreshProgress" progress="-1" visible="false" prefHeight="20.0" prefWidth="20.0" />
            </children>
            <padding>
                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
            </padding>
        </HBox>
    </top>
    
    <!-- Contenu principal -->
    <center>
        <StackPane>
            <children>
                <VBox spacing="5.0" fx:id="inboxContainer">
                    <padding>
                        <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
                    </padding>
                    <children>
                        <!-- Barre d'action -->
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                            <children>
                                <Button fx:id="newMessageButton" styleClass="button-primary" text="Nouveau message" />
                                <Label text="BoÃ®te de rÃ©ception">
                                    <font>
                                        <Font name="System Bold" size="16.0" />
                                    </font>
                                </Label>
                                <Label fx:id="emailCountLabel" styleClass="badge" text="0" />
                            </children>
                            <VBox.margin>
                                <Insets bottom="10.0" top="10.0" />
                            </VBox.margin>
                        </HBox>
                        
                        <!-- Liste des emails -->
                        <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="email-list-container">
                            <content>
                                <StackPane>
                                    <children>
                                        <!-- Vue par dÃ©faut avec des emails - ListView pour afficher tous les messages -->
                                        <ListView fx:id="emailListView" styleClass="email-list" VBox.vgrow="ALWAYS" />
                                        
                                        <!-- Vue pour boÃ®te de rÃ©ception vide - S'assurer que le bouton est toujours accessible -->
                                        <VBox fx:id="emptyInboxView" alignment="CENTER" styleClass="empty-inbox" visible="false">
                                            <children>
                                                <Text styleClass="icon" text="ðŸ“­" />
                                                <Text text="Aucun message dans votre boÃ®te de rÃ©ception" />
                                                <Text text="Les nouveaux messages apparaÃ®tront ici" />
                                                <Button fx:id="emptyRefreshButton" styleClass="button-secondary" text="Actualiser">
                                                    <VBox.margin>
                                                        <Insets top="15.0" />
                                                    </VBox.margin>
                                                </Button>
                                            </children>
                                        </VBox>
                                    </children>
                                </StackPane>
                            </content>
                        </ScrollPane>
                    </children>
                </VBox>
                
                <!-- Overlay de chargement global -->
                <StackPane fx:id="loadingOverlay" styleClass="spinner-overlay" visible="false">
                    <children>
                        <VBox alignment="CENTER" spacing="15">
                            <ProgressIndicator progress="-1" />
                            <Label text="Chargement en cours..." />
                        </VBox>
                    </children>
                </StackPane>
            </children>
        </StackPane>
    </center>
</BorderPane>
